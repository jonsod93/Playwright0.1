# Test info

- Name: Unauthenticated Card Purchase Tests >> Card purchase successful
- Location: /home/runner/work/Playwright0.1/Playwright0.1/tests/filmstaden_int/purchases/cardPurchase.spec.js:33:3

# Error details

```
Error: expect.toContainText: Error: strict mode violation: locator('//div[@class=\'shrink-0 text-right font-bold\']') resolved to 2 elements:
    1) <div class="shrink-0 text-right font-bold">2 st</div> aka getByText('2 st').first()
    2) <div class="shrink-0 text-right font-bold">2 st</div> aka getByText('2 st').nth(1)

Call log:
  - expect.toContainText with timeout 10000ms
  - waiting for locator('//div[@class=\'shrink-0 text-right font-bold\']')

    at /home/runner/work/Playwright0.1/Playwright0.1/tests/filmstaden_int/purchases/cardPurchase.spec.js:48:51
    at /home/runner/work/Playwright0.1/Playwright0.1/tests/filmstaden_int/purchases/cardPurchase.spec.js:46:5
```

# Page snapshot

```yaml
- main:
  - link "Filmstaden logotype":
    - /url: /stockholm/
    - img "Filmstaden logotype"
  - heading "(3D) Titanic - Klassiker" [level=1]
  - text: Eng tal, Sve text I dag 17 maj, kl 17:00 Filmstaden Täby, Salong 2
  - link "Logga in och samla poäng":
    - /url: https://inte-services.cinema-api.com/redirect/externalSignUpOrIn/se?redirectUrl=https://sv-sit-marvel.filmstaden.se/bokning/kop/63b68f4b-68d3-49a5-b282-2f709002bca2/
  - button ""
  - heading "Rubrik" [level=4]
  - paragraph: Nu kan du få det! Det enda du behöver göra är att köpa en biljett och bla bla bla bla bla bla och du har chans att vinna!
  - paragraph:
    - link "Läs mer om villkoren här":
      - /url: /familj/barnens-biodag-pa-filmstaden/
  - heading "Servering" [level=4]
  - paragraph: Unna dig en god drink eller en kall öl från vår barmeny medan du tittar på filmen. Kom ihåg att föreställningens ordinarie åldersgräns gäller för inträde.
  - heading "Välj antal biljetter" [level=2]
  - paragraph: Ordinarie
  - button "-": 
  - spinbutton "Ordinarie" [disabled]: "1"
  - img
  - button "+": 
  - paragraph: Pensionär
  - paragraph: Pensionärserbjudande - 10% rabatt
  - button "-" [disabled]: 
  - spinbutton "Pensionär" [disabled]: "0"
  - img
  - button "+": 
  - heading "Välj antal 3D-glasögon" [level=2]
  - paragraph: 3D-glasögon
  - paragraph: 20 kr/st
  - button "-": 
  - spinbutton "3D-glasögon" [disabled]: "1"
  - img
  - button "+" [disabled]: 
  - heading "Välj platser" [level=2]
  - text: "Vi har förvalt de bästa platserna. Byt plats genom att dra markören. Valda platser: Rad 5 Plats 69-70"
  - img
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - img
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - img
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - img
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - img
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - img
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - img
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - img
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - img
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - img
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - img
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - img
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - img
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - img
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - img
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - img
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - img
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - img
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - img
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - img
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - img
  - 'checkbox "Valda platser: Rad 5 Plats 69-70" [disabled]'
  - checkbox "Välj skilda platser"
  - text: Välj skilda platser
  - img
  - img
  - text: Ditt val Ordinarie
  - img
  - text: Upptagen
  - img
  - text: Rullstol Plus VIP Premium Daybed Recliner+ Soffa
  - button "Salongsinformation"
  - heading "Använd rabattkod" [level=2]
  - text: Rabatt- och biljettkoder, biokort samt biopasset.
  - button "Lös in in rabattkod"
  - heading "Biljettleverans" [level=2]
  - paragraph: För biljetter och bokningsbekräftelse.
  - text: Ange en e-postadress
  - textbox "Ange en e-postadress"
  - heading "Betalning" [level=2]
  - paragraph: All data krypteras
  - separator
  - heading "Använd presentkort" [level=3]
  - text: Har du ett presentkort? Använd den för ditt köp.
  - button "Lös in ditt presentkortsnummer"
  - separator
  - heading "Välj betalsätt" [level=3]
  - list:
    - listitem:
      - radio "Kort" [checked]
      - text: Kort
    - listitem:
      - radio "Swish"
      - text: Swish
  - separator
  - checkbox "Jag är medveten om att filmen är tillåten från 11 år. Barn som har fyllt 7 år får dock medfölja i vuxens (18 år) sällskap."
  - paragraph: Jag är medveten om att filmen är tillåten från 11 år. Barn som har fyllt 7 år får dock medfölja i vuxens (18 år) sällskap.
  - button "Fortsätt till kortbetalning" [disabled]:
    - img
    - text: Fortsätt till kortbetalning
  - paragraph:
    - text: Genom att fortsätta godkänner du
    - link "Filmstadens köpvillkor":
      - /url: /kundservice/fragor-och-svar/villkor-och-policies/filmstadens-kopvillkor/
    - text: .
  - paragraph:
    - text: Läs om hur vi värnar om din integritet i
    - link "Filmstadens personuppgiftspolicy":
      - /url: /kundservice/fragor-och-svar/villkor-och-policies/personuppgiftspolicy/
  - text: "Ordinarie VIP 2 st 438.00 kr 3D-glasögon 2 st 40.00 kr Summa: 478.00 kr"
- text: Navigated to Se "Titanic - Klassiker" på bio - Köp biobiljett online | Filmstaden
```

# Test source

```ts
   1 | import { test, expect } from '@playwright/test';
   2 | import { LandingPage } from '../../../pages/filmstaden_int/Landingpage';
   3 | import { StartPage } from '../../../pages/filmstaden_int/StartPage';
   4 | import { MoviePage } from '../../../pages/filmstaden_int/MoviePage';
   5 | import { ShowPage } from '../../../pages/filmstaden_int/ShowPage';
   6 | import { NetsPage } from '../../../pages/filmstaden_int/NetsPage';
   7 | import { ReceiptPage } from '../../../pages/filmstaden_int/ReceiptPage';
   8 | import { TestUser } from '../../../testData/testUser';
   9 | import { ValidVisa } from '../../../testData/paymentOptions';
  10 | import * as allure from 'allure-js-commons';
  11 |
  12 | test.describe.parallel('Unauthenticated Card Purchase Tests', () => {
  13 |   let landingPage;
  14 |   let startPage;
  15 |   let moviePage;
  16 |   let showPage;
  17 |   let netsPage;
  18 |   let receiptPage;
  19 |
  20 |   test.beforeEach(async ({ page }) => {
  21 |     landingPage = new LandingPage(page);
  22 |     startPage = new StartPage(page);
  23 |     moviePage = new MoviePage(page);
  24 |     showPage = new ShowPage(page);
  25 |     netsPage = new NetsPage(page);
  26 |     receiptPage = new ReceiptPage(page);
  27 |
  28 |     await page.goto('/');
  29 |     await landingPage.acceptCookies();
  30 |     await landingPage.selectStockholm();
  31 |   });
  32 |
  33 |   test('Card purchase successful', async ({ page }) => {
  34 |     await test.step('Initial setup of variables and tags', async () => {
  35 |       await allure.epic('Purchases');
  36 |       await allure.feature('Successful Card Purchase');
  37 |     });
  38 |
  39 |     await test.step('Navigate to a movie with shows', async () => {
  40 |       await startPage.selectRandomMovie();
  41 |       await moviePage.selectFirstAvailableShowtime(
  42 |         startPage.selectRandomMovie.bind(startPage)
  43 |       );
  44 |     });
  45 |
  46 |     await test.step('Select 1 ticket and fill in required fields', async () => {
  47 |       await showPage.selectOneTicket();
> 48 |       await expect(showPage.amountOfTicketsLabel).toContainText('1 st');
     |                                                   ^ Error: expect.toContainText: Error: strict mode violation: locator('//div[@class=\'shrink-0 text-right font-bold\']') resolved to 2 elements:
  49 |       await showPage.fillEmail(TestUser.email);
  50 |       await showPage.acceptAgeLimit();
  51 |       await showPage.startPayment();
  52 |     });
  53 |
  54 |     await test.step('Make the purchase at Nets', async () => {
  55 |       await netsPage.completePayment(
  56 |         ValidVisa.number,
  57 |         ValidVisa.month,
  58 |         ValidVisa.year,
  59 |         ValidVisa.CVC
  60 |       );
  61 |     });
  62 |
  63 |     await test.step('Control that you end up on the receiptpage', async () => {
  64 |       await expect(async () => {
  65 |         await expect(receiptPage.referensNumberTitleLabel).toContainText(
  66 |           'Referensnummer'
  67 |         );
  68 |       }).toPass({ timeout: 15000 });
  69 |     });
  70 |   });
  71 |
  72 |   test('No Email Error', async ({ page }) => {
  73 |     await allure.epic('Purchases');
  74 |     await allure.feature('No Email in checkout');
  75 |
  76 |     await test.step('Navigate to a suitable movie', async () => {
  77 |       await startPage.selectRandomMovie();
  78 |       await moviePage.selectFirstAvailableShowtime(
  79 |         startPage.selectRandomMovie.bind(startPage)
  80 |       );
  81 |     });
  82 |
  83 |     await test.step('Select 1 ticket and fill in necessary fields', async () => {
  84 |       await showPage.acceptAgeLimit();
  85 |       await showPage.startPayment();
  86 |       await expect(async () => {
  87 |         await expect(
  88 |           page.locator(
  89 |             "//div[contains(text(),'Felaktigt format på e-postadress')]"
  90 |           )
  91 |         ).toContainText('Felaktigt format på e-postadress');
  92 |       }).toPass({ timeout: 5000 });
  93 |     });
  94 |   });
  95 | });
  96 |
```